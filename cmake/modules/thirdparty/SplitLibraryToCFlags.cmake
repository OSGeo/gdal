
function(split_library_to_cflags _lib _result)
    if(_lib)
        set(RESULT)
        get_filename_component(_lib_name ${_lib} NAME_WE)
        if(_lib_name STREQUAL "")
        else()
            string(REGEX REPLACE "^lib" "" _lib_name ${_lib_name})
            get_filename_component(_lib_dir ${_lib} PATH)
            if("${_lib_dir}" STREQUAL "")
                if(_lib_name MATCHES "-l.*")
                    # e.g "-lm"
                    set(RESULT "${_lib_name}")
                else()
                    # e.g. "dl"
                    set(RESULT "${CMAKE_LINK_LIBRARY_FLAG}${_lib_name}")
                endif()
            else()
                if(_lib_dir MATCHES "${CMAKE_LIBRARY_ARCHITECTURE_REGEX}")
                    set(RESULT "${CMAKE_LINK_LIBRARY_FLAG}${_lib_name}")
                elseif(_lib_dir MATCHES "^/usr/lib$")
                    set(RESULT "${CMAKE_LINK_LIBRARY_FLAG}${_lib_name}")
                else()
                    set(RESULT "${CMAKE_LIBRARY_PATH_FLAG}${_lib_dir}")
                    list(APPEND RESULT "${CMAKE_LINK_LIBRARY_FLAG}${_lib_name}")
                endif()
            endif()
        endif()
        set(${_result} "${RESULT}" PARENT_SCOPE)
    endif()
endfunction()
