<html>
<head>
<title>WCS -- OGC Web Coverage Service</title>
</head>

<body bgcolor="#ffffff">

<h1>WCS -- OGC Web Coverage Service</h1>

The optional GDAL WCS driver allows use of a coverage in a WCS server as a
raster dataset.  GDAL acts as a client to the WCS server.<p>

Accessing a WCS server is accomplished by creating a local service description
xml file looking something like the following, with the coverage server url,
and the name of the coverage to access.  It is important that there be no
spaces or other content before the <tt>&lt;WCS_GDAL&gt;</tt> element.<p>

<pre>
&lt;WCS_GDAL&gt;
  &lt;ServiceURL&gt;http://laits.gmu.edu/cgi-bin/NWGISS/NWGISS?&lt;/ServiceURL&gt;
  &lt;CoverageName&gt;AUTUMN.hdf&lt;/CoverageName&gt;
&lt;/WCS_GDAL&gt;
</pre>

When first opened, GDAL will fetch the coverage description, and a small test
image to establish details about the raster.  This information will be cached
in the service description file to make future opens faster - no server access
should be required till imagery is read for future opens.<p>

The WCS driver should support WCS 1.0.0 and 1.1.0 servers, but WCS 0.7 servers
are not supported.  Any return format that is a single file, and is in a format
supported by GDAL should work.  The driver will prefer a format with "tiff"
in the name, otherwise
it will fallback to the first offered format.   Coordinate systems are read
from the DescribeCoverage result, and are expected to be in the form of
<tt>EPSG:n</tt> in the <tt>&lt;supportedCRSs&gt;</tt> element. <p>

The service description file has the following additional elements as
immediate children of the <tt>WCS_GDAL</tt> element that may be optionally
set.<p>

<ul>
<li> <b>PreferredFormat</b>: the format to use for GetCoverage calls.<p>
<li> <b>BandCount</b>: Number of bands in the dataset, normally captured from the sample request.
<li> <b>BandType</b>: The pixel data type to use.  Normally established from the sample request.
<li> <b>BlockXSize</b>: The block width to use for block cached remote access.
<li> <b>BlockYSize</b>: The block height to use for block cached remote access.
<li> <b>NoDataValue</b>: The nodata value to use for all the bands (blank for none).  Normally defaulted from CoverageOffering info.
<li> <b>Timeout</b>: The timeout to use for remote service requests.  If not provided, the libcurl default is used.
<li> <b>USERPWD</b>: May be supplied with <i>userid:password</i> to pass a
userid and password to the remote server.
<li> <b>HTTPAUTH</b>: May be BASIC, NTLM or ANY to control the authentication scheme to be used.
<li> <b>OverviewCount</b>: The number of overviews to represent bands as having.  Defaults to a number such that the top overview is fairly smaller (less than 1K x 1K or so).
<li> <b>GetCoverageExtra</b>: An additional set of keywords to add to GetCoverage requests in URL encoded form.  eg. "&RESAMPLE=BILINEAR&Band=1"
<li> <b>DescribeCoverageExtra</b>: An additional set of keywords to add to DescribeCoverage requests in URL encoded form.  eg. "&CustNo=775"
<li> <b>Version</b>:  Set a specific WCS version to use.  Currently defaults to 1.0.0 and 1.1.0 is also supported.
<li> <b>FieldName</b>: Name of the field being accessed.  Used only with WCS 1.1.0+.  Defaults to the first field in the DescribeCoverage result.
<li> <b>DefaultTime</b>: A timePosition to use by default when accessing
coverages with a time dimension.  Populated with the last offered time
position by default.
</ul>

<h3>"WCS:" format for dataset name, caching, and version 2.0.1 servers</h3>

<p>
  Starting with GDAL 2.3.0, this driver supports "WCS:&lt;URL&gt;"
  format for the WCS dataset name. When using this format the WCS_GDAL
  XML service files are not meant to be written by the user. The
  driver will maintain a cache for the Capabilities, (PAM) metadata,
  coverage description, and service files. Also starting with GDAL
  2.3.0 the driver includes support for version 2.0.1 servers.
</p>
<p>
  The URL in the dataset name is not a complete WCS request URL. The
  request URL, specifically, its query part, for GetCapabilities,
  DescribeCoverage, and GetCoverage requests is composed by the
  driver. The URL, version and coverage attributes in the query
  standardised into 'version' and 'coverage', is used as keys to the
  cache database of server responses, GDAL metadata files, and GDAL
  service files. The user should include into the URL values for
  version and eventually for coverage attributes, and all extra
  attributes that the server in question may recognize, and other
  attributes not managed by the driver. However, noting that the URL
  is a key to the cache, the user should consider using
  GetCoverageExtra and DescribeCoverageExtra options to avoid some
  attribute-value pairs becoming keys in the cache.
</p>

<p>
  The supposed workflow of the driver is as follows (an example with
  gdalinfo). At each step the command
  <pre>gdalinfo -oo &lt;option=value&gt; "WCS:&lt;URL&gt;"</pre>
  is given with varying options and URL.
  At each point the HTTP options
  <ul>
    <li>TimeOut=value</li>
    <li>USERPWD=value</li>
    <li>HTTPAUTH=value</li>
  </ul>
  the common cache control options
  <ul>
    <li>CACHE_DIR=path (The default location of the cache
      directory is $HOME/.gdal/wcs_cache)</li>
    <li>CLEAR_CACHE=TRUE (The cache is completely initialized and all
      files are deleted.)</li>
    <li>REFRESH_CACHE=TRUE (The cache entry is deleted.)</li>
    <li>RECREATE_META=TRUE (The metadata file (.aux.xml) is recreated,
    either the server, server at a version, or the coverage related
      metadata file.)</li>
    <li>RECREATE_SERVICE=TRUE (The service (WCS_GDAL) XML file is
      initialized. Note that the service file is always updated with
      elements given as options.</li>
  </ul>
  More than one option can be given by repeating the -oo switch.
  <ol>
    <li>Initially the URL may be plain URL for the server, but it may
      also contain a request for the server to use a specific version
      (for example "http://example.com/server?version=2.0.1"). The
      driver attempts to fetch the Capabilities file from the server,
      save it to the cache, parse it, create metadata describing the
      server and coverage offering, save that to the cache (same key
      is used), and show it to the user. Coverages are recorded as
      subdatasets.  Subsequent use of the driver using the "WCS:"
      format will reuse the metadata obtained from the Capabilities
      file unless asked to refresh or recreate.
    </li>
    <li>
      Once the coverage offering of the server is known, a coverage
      name/id can be added to the URL as a parameter (key may be
      'coverageId', 'identifiers', or 'coverage'; 'coverage' is
      always used in the cache key). Given that, the driver attempts
      to fetch the coverage description from the server, save it to
      the cache (a new key is used), parse it, and create a service
      file. At this point, when the version 2.0.1 is used, the driver
      may map the data fields into raster bands. However, if the
      coverage contains more than two dimensions, nothing is yet
      mapped to bands. The user needs to use the Dimensions or the
      DimensionToBand option to either define the value at which the
      extra dimension is sliced or that it is mapped as bands. If the
      DimensionToBand option is selected, it may be necessary to also
      define with the Range option the field that is put as data into
      the bands.
      <ul>
        <li><b>PreferredFormat</b>=<i>name</i> Override the default
          format selected by the driver. Should be one of the server
          supported formats.</li>
        <li><b>Interpolation</b>=<i>name</i> Override the default
          interpolation selected by the driver. Should be one of the server
          supported formats.</li>
        <li><b>Domain</b>=<i>axis_name,axis_name</i> The axes that are
        used for the spatial dimensions. The default is to use the
        first two axes given by the server. The axis order swap may
        apply.</li>
        <li><b>Dimensions</b>=<i>axis_name(trim_begin_value,trim_end_value);axis_name(slice_value)</i>
        Trim or slice a dimension when fetching data from the server.</li>
        <li><b>DimensionToBand</b>=<i>axis_name</i> Map the given dimension, for
          example 'time', into bands.</li>
        <li><b>DefaultTime</b> See above, only for 1.0.0.</li>
        <li><b>FieldName</b>=<i>field_name,field_name:field_name,..</i>
        A list of fields to be mapped to
        bands. A <i>field_name:field_name</i> in the list denotes a
        range of fields. If not set, defaults to the first field in
        the coverage description in versions 1.0 and 1.1.</li>
        <li><b>OverviewCount</b> See above.</li>
        <li><b>GetCoverageExtra</b> See above.</li>
        <li><b>DescribeCoverageExtra</b> See above.</li>
        <li><b>BlockXSize</b> See above.</li>
        <li><b>BlockYSize</b> See above.</li>
        <li><b>NoDataValue</b>=<i>value,value,..</i> ('no data' values
        for the fields)</li>
      </ul>
    </li>
    <li>Once the service file is such that it specifies bands, it can
    be used for requesting data from the server.
    </li>
  </ol>
</p>

<p>Servers have bugs. The following options are for fixing them on the
  client side.
  <ul>
    <li><b>SKIP_GETCOVERAGE</b>=TRUE (The driver will not make a
        GetCoverage request to the server, which it usually does if it
        can't determine the band count and band data type from the
        capabilities or coverage descriptions. This option may be
      needed if GetCoverage request fails.)</li>
    <li><b>OriginNotCenter100</b>=<i>TRUE</i> Some MapServers set the
    grid origin to the pixel boundary instead of setting it to the
      pixel center.</li>
    <li><b>OuterExtents</b>=<i>TRUE</i> WCS 1.1 extents are centers of
    outer pixels. However, some GeoServers want the extents as
      boundaries or outer pixels.
    <li><b>BufSizeAdjust</b>=<i>value</i> In WCS 1.1 one can't set the
      size of the requested tile in pixels. GDAL call to dataset data
      fails if the response is not expected size. In some cases this
      value needs to be set to a value of 0.5 to get the requested
      size.</li>
    <li><b>OffsetsPositive</b>=<i>TRUE</i>
    and <b>NrOffsets</b>=<i>2</i> The WCS 1.1 standard says that when
    the grid is of type 2dGridIn2dCrs, which is the simplest one,
    GridOffsets should have four values. However, some servers expect
    there to be only two (MapServer and ArcGIS) and MapServer expects
      them to be both positive.
    <li><b>GridCRS</b>=<i>TRUE</i> If a WCS 1.1 request is not
    scaled GDAL traditionally has left the Grid* parameters away from
    the GetCoverage request. Setting this option forces them into the
      request. Needed for GeoServer.</li>
    <li><b>NoGridAxisSwap</b>=<i>TRUE</i> When reading the grid
      geometry (in 1.1 origin and offsets, in 2.0.1 envelope, axis
      labels, and offsets) no axis order swap is done although it
      would otherwise be done. In 1.1 it would be done if the CRS has
      inverted axes. In 2.0.1 it would be done if the axisOrder of the
      sequenceRule in GridFunction defines os. This is needed usually
      both in 1.1 and 2.0.1 when parsing coverage descriptions from
      MapServer and GeoServer. Note that the </li>
    <li><b>GridAxisLabelSwap</b>=<i>TRUE</i> When reading the grid
      axis labels from 2.0.1 coverage description they are swapped
      even though there is no GridFunction to tell so. May be needed
      for MapServer in version 2.0.1 if the CRS axis order is
      swapped.</li>
    <li><b>SubsetAxisSwap</b>=<i>TRUE</i> When making WCS 2.0.1
        GetCoverage request, the driver will swap the axis names given
        in boundedBy.Envelope.axisLabels. May be needed for GeoServer
      when EPSG dictates axis order swap.</li>
    <li><b>UseScaleFactor</b>=<i>TRUE</i> When making WCS 2.0.1
        GetCoverage request, the driver will use scale by factor
        approach instead of scale to size. This is required when the server is ArcGIS.</li>
  </ul>
</p>

<h3>Time</h3>

Starting with GDAL 1.9.0, this driver includes experimental support for time based WCS 1.0.0 servers.
On initial access the last offered time position will be identified as the
DefaultTime.  Each time position available for the coverage will be treated
as a subdataset. <p>

Note that time based subdatasets are not supported when the service description
is the filename.  Currently time support is not available for versions other
than WCS 1.0.0.  <p>

See Also:<p>

<ul>
<li> <a href="http://www.opengeospatial.org/standards/wcs">OGC WCS Standards</a>
</ul>

</body>
</html>
